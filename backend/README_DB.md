# Работа с базой данных

## Автоматическое создание БД

База данных создается автоматически при первом запуске приложения. Система:

1. Проверяет существование БД
2. Создает БД, если её нет
3. Создает все необходимые таблицы

## Ручное создание БД

Если нужно создать БД вручную:

```bash
# Через скрипт инициализации
python -m app.init_db
```

Этот скрипт:
- Создаст БД, если её нет
- Создаст все таблицы
- Покажет список созданных таблиц

## Создание администратора

### Интерактивный режим:
```bash
python -m app.scripts.create_admin
```

### С параметрами:
```bash
python -m app.scripts.create_admin admin@itwin.kz password123 "Администратор"
```

## Структура таблиц

После инициализации будут созданы следующие таблицы:

- `users` - пользователи системы
- `content_items` - элементы контента
- `media_files` - медиа файлы
- `demo_requests` - заявки на демо
- `seo_metadata` - SEO метатеги
- `pages` - страницы сайта
- `sections` - секции страниц

## Миграции Alembic

Если используете Alembic для миграций:

```bash
# Создать новую миграцию
alembic revision --autogenerate -m "Описание изменений"

# Применить миграции
alembic upgrade head

# Откатить последнюю миграцию
alembic downgrade -1
```

## Подключение к БД

Параметры подключения настраиваются в `.env`:

```env
DATABASE_URL=postgresql://postgres:Danil228@localhost:5440/sirius_db
```

Формат: `postgresql://user:password@host:port/database`

## Troubleshooting

### Ошибка "database does not exist"
- Убедитесь, что PostgreSQL запущен
- Проверьте права пользователя на создание БД
- Попробуйте создать БД вручную через `psql`

### Ошибка подключения
- Проверьте, что порт 5440 доступен
- Убедитесь, что пароль правильный
- Проверьте настройки `pg_hba.conf` в PostgreSQL

### Ошибка создания таблиц
- Убедитесь, что все модели импортированы
- Проверьте логи на наличие ошибок
- Попробуйте удалить БД и создать заново

